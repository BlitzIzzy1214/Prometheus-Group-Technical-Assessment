/**
 * This file shows the raw code that was generated by codegen while traversing from Google to Prometheus Group's website.
 * It contains options to make the program headed in an attempt to avoid Google's CAPTCHA.
 */

using Microsoft.Playwright;
using System;
using System.Threading.Tasks;
using Microsoft.Playwright.Xunit;

namespace PlaywrightTests {

    public class PlaywrightTests {

        [Fact]
        public async Task TestContactUs()
        {
            using var playwright = await Playwright.CreateAsync();

            await using var browser = await playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions
            {
                Headless = false,
            });

            var context = await browser.NewContextAsync();

            var page = await context.NewPageAsync();
            await page.GotoAsync("https://www.google.com/");
            await page.GetByRole(AriaRole.Combobox, new() { Name = "Search" }).ClickAsync();
            await page.GetByRole(AriaRole.Combobox, new() { Name = "Search" }).FillAsync("Prometheus Group");
            await page.GotoAsync("https://www.google.com/search?q=Prometheus+Group&sca_esv=711e3a4e3d7f8646&source=hp&ei=qKf6aOSSC4PMp84PwpCamAQ&iflsig=AOw8s4IAAAAAaPq1uEeDGD4c9S79HCL2gaU4WhpXYQwx&ved=0ahUKEwjkhviFq7uQAxUD5skDHUKIBkMQ4dUDCBA&uact=5&oq=Prometheus+Group&gs_lp=Egdnd3Mtd2l6IhBQcm9tZXRoZXVzIEdyb3VwMg0QABiABBixAxhDGIoFMgsQLhiABBjHARivATIFEAAYgAQyBRAAGIAEMgUQABiABDIFEAAYgAQyBRAAGIAEMgUQABiABDIFEAAYgAQyBRAAGIAESPYXUM4FWOEUcAF4AJABAJgBZ6ABywqqAQQxNC4yuAEDyAEA-AEBmAIRoALtCqgCCsICFhAuGIAEGEMYtAIYxwEYigUY6gIYrwHCAhYQLhiABBjRAxhDGLQCGMcBGIoFGOoCwgIQEAAYgAQYQxi0AhiKBRjqAsICGhAAGIAEGLQCGNQDGOUCGLcDGIoFGOoCGIoDwgIKEAAYgAQYQxiKBcICEBAuGIAEGEMYxwEYigUYrwHCAgoQLhiABBhDGIoFwgINEC4YgAQYsQMYQxiKBcICCBAAGIAEGLEDwgIIEC4YgAQYsQPCAgsQABiABBixAxiDAZgDAvEFhgzGaRF1vNaSBwQxNS4yoAfhmgGyBwQxNC4yuAfrCsIHBDQuMTPIBxY&sclient=gws-wiz");
            await Expect(page.GetByRole(AriaRole.Link, new() { Name = "Prometheus Group: Asset" })).ToBeVisibleAsync();
            await Expect(page.GetByRole(AriaRole.Link, new() { Name = "Contact Us" })).ToBeVisibleAsync();
            await page.GetByRole(AriaRole.Link, new() { Name = "Contact Us" }).ClickAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "First Name*" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "Last Name*" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "Business Email Address*" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "Phone number*" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "Company name*" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("#label-global_region-fe70f03d-5bac-4ad3-a698-3e130182d674_7317").GetByText("*")).ToBeVisibleAsync();
            await Expect(Page.Locator("#label-my_primary_system-fe70f03d-5bac-4ad3-a698-3e130182d674_7317").GetByText("*")).ToBeVisibleAsync();
            await Expect(Page.Locator("label").Filter(new() { HasText = "What product are you" }).Locator("span").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("section")).ToMatchAriaSnapshotAsync("- heading \"Let's get your information\" [level=2]\n- text: First Name*\n- textbox \"First Name*\"\n- text: Last Name*\n- textbox \"Last Name*\"\n- text: Business Email Address* Please enter a valid business email.\n- textbox \"Business Email Address*\"\n- text: Phone number*\n- textbox \"Phone number*\"\n- text: Company name*\n- textbox \"Company name*\"\n- text: Global Region*\n- combobox \"Global Region*\":\n  - option \"Please Select\" [disabled] [selected]\n  - option \"EMEA\"\n  - option \"LATAM\"\n  - option \"North America\"\n  - option \"APAC\"\n- text: My Primary System*\n- combobox \"My Primary System*\":\n  - option \"Please Select\" [disabled] [selected]\n  - option \"SAP\"\n  - option \"IBM Maximo\"\n  - option \"Oracle\"\n  - option \"Other\"\n- text: What product are you interested in?*\n- combobox \"What product are you interested in?*\":\n  - option \"Please Select\" [disabled] [selected]\n  - option \"Planning & Scheduling\"\n  - option \"Mobility\"\n  - option \"Permitting and Safety\"\n  - option \"Reporting and Analytics\"\n  - option \"Shutdown, Turnaround & Outage\"\n  - option \"Prometheus RiskPoynt\"\n  - option \"Construction and Commissioning Management\"\n  - option \"Contractor Management\"\n  - option \"APM\"\n  - option \"Capital Projects\"\n  - option \"Master Data as a Service\"\n  - option \"Master Data Governance\"\n  - option \"Asset Information Workbench\"\n  - option \"Retail Fashion Management\"\n- text: \"Additional Comments or Questions:\"\n- textbox \"Additional Comments or Questions:\"\n- paragraph:\n  - text: By submitting, you consent to the use of your personal data in accordance to Prometheus Group's\n  - link \"privacy policy\":\n    - /url: https://prometheusgroup-hs-sites-com.sandbox.hs-sites.com/company/privacy-policy\n  - text: .\n- button \"Contact Us\"");
            await Page.GetByRole(AriaRole.Textbox, new() { Name = "First Name*" }).ClickAsync();
            await Page.GetByRole(AriaRole.Textbox, new() { Name = "First Name*" }).FillAsync("First");
            await Page.GetByRole(AriaRole.Textbox, new() { Name = "Last Name*" }).ClickAsync();
            await Page.GetByRole(AriaRole.Textbox, new() { Name = "Last Name*" }).FillAsync("Last");
            await Expect(Page.GetByRole(AriaRole.Textbox, new() { Name = "Business Email Address*" })).ToBeEmptyAsync();
            await Expect(Page.GetByRole(AriaRole.Textbox, new() { Name = "Phone number*" })).ToBeEmptyAsync();
            await Expect(Page.GetByRole(AriaRole.Textbox, new() { Name = "Company name*" })).ToBeEmptyAsync();
            await Page.GetByRole(AriaRole.Button, new() { Name = "Contact Us" }).ClickAsync();
            await Expect(Page.GetByRole(AriaRole.Textbox, new() { Name = "First Name*" })).ToHaveValueAsync("First");
            await Expect(Page.GetByRole(AriaRole.Textbox, new() { Name = "Last Name*" })).ToHaveValueAsync("Last");
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "Business Email Address*Please" }).Locator("label").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "Phone number*Please complete" }).Locator("label").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "Company name*Please complete" }).Locator("label").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "Global Region*Please" }).Locator("label").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "My Primary System*Please" }).Locator("label").Nth(1)).ToBeVisibleAsync();
            await Expect(Page.Locator("[data-test-id=\"hsForm_fe70f03d-5bac-4ad3-a698-3e130182d674_7317\"] div").Filter(new() { HasText = "What product are you" }).Locator("label").Nth(1)).ToBeVisibleAsync();
        }
    }
}
